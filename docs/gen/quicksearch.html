<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Global Members askforleave abnormal true,检查各个时间段，影响考勤规则，否则，直接读考勤状态 express :exports|module.exports 获得统计分析数据的模块 url：/getStatistic Type: exports | module.exports schedule :exports|module.exports Type: exports | module.exports Methods countByDepartment(req, res) Parameters: Name Type Description req departmentId,部门id，startTime,endTime, countType:events|personel|spotares,timespan:day|week|month|year res - countByMessages(req, res) Parameters: Name Type Description req personId,人员id，startTime,endTime, countType:events|personel|spotares,timespan:day|week|month|year res - × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Modules × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%9D%97%20url_%20%20_personalinfo.html":{"id":"module-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%9D%97%20url_%20%20_personalinfo.html","title":"Module: 个人信息配置模块 url:  /personalinfo","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 个人信息配置模块 url: /personalinfo Methods &lt;inner&gt; getpersonrecordTodepartment(req, res) 获取一个部门的所有人员考勤 Parameters: Name Type Description req json 传入部门id和时间段json数据，例如{departmentID:'123456',startTime:date,endTime:Date} res json 返回成功后的json 例如：[{}] &lt;inner&gt; getpersonrecordtoid(req, res) 获取一个人的考勤记录 Parameters: Name Type Description req json 传入人员和时间段json数据，例如{personID:'123456',startTime:date,endTime:Date} res json 返回成功后的json 例如：[{}] &lt;inner&gt; getpersontwocode(req, res) 二维码扫描，登录桌面端 - 待完善 Parameters: Name Type Description req json 客户端提交json，例如{_id:'用户id',idNum:'用户身份证'} res json 手机自动填入登陆信息，登陆客户端界面 &lt;inner&gt; personjsResignation(req, res) 离职 - 暂时不做 Parameters: Name Type Description req json 传入人员和时间json数据，例如{personID:'123456',startTime:date,endTime:Date} res json 返回成功后的json 例如：{success:''} &lt;inner&gt; sendpersonaskforleave(req, res) 人员请假 Parameters: Name Type Description req json 传入人员请假json数据，例如{personID:'123456',startTime:date,endTime:Date,reason:'请假理由'} res json 返回成功后的json 例如：{success:''} &lt;inner&gt; sendpersoninfoerr(req, res) 身份信息有误上报 - 待完善 Parameters: Name Type Description req json res json &lt;inner&gt; sendpersonleave(req, res) 脱岗 - 暂时不做 Parameters: Name Type Description req json 传入人员和时间json数据，例如{personID:'123456',startTime:date,endTime:Date} res json 返回成功后的json 例如：{success:''} &lt;inner&gt; sendpersonshift(req, res) 换班 Parameters: Name Type Description req json 传入人员和时间json数据，例如{personID:'123456',startTime:date,endTime:Date,shift:'换班人ID'} res json 返回成功后的json 例如：{success:''} &lt;inner&gt; updatepersonpassword(req, res) 修改自己的个人密码，必须输入原密码 Parameters: Name Type Description req json 客户端提交json，没有id可以提交身份证号， 例如{_id:'用户id',idNum:'用户身份证',opwd:'原密码',npwd:'新密码'} res json 返回提示修改成功，或者原密码错误 × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E5%9C%B0%E5%9B%BE%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%20url_%20_map.html":{"id":"module-%E5%9C%B0%E5%9B%BE%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%20url_%20_map.html","title":"Module: 地图功能模块 url: /map","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 地图功能模块 url: /map Methods &lt;inner&gt; addperson(req, res) 进行网格和人员绑定 Parameters: Name Type Description req json 客户端提交json 例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:{job:'职务'},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回bool值，true：激活用户，false：客户端提示是否需要管理员审核 &lt;inner&gt; getcameraposition(req, res) 获取摄像头位置--未完成 Parameters: Name Type Description req 请求地址，无需传参 res json 返回json ，例如[{location：[109，38]，videoUrl：video.sohu.com，name：“保平村路口”，type：&quot;球形摄像头&quot;，protocol：“rstp”}] &lt;inner&gt; geteventposition(req, res) 待办事件坐标点 Parameters: Name Type Description req 请求地址，无需传参 res json 返回json ，例如[{_id:&quot;事件ID&quot;,name:&quot;无照经营&quot;,position:[&quot;116.446587&quot;,&quot;39.909989&quot;],newer:&quot;更新时间&quot;}] &lt;inner&gt; getmapdisplaysetting(req, res) 地图显示配置-未完成 选择显示同事，代办案件，网格区域，摄像头 Parameters: Name Type Description req json 客户端提交JSON 例如{“person“:true,&quot;case&quot;:false,&quot;area&quot;:true,&quot;camera&quot;:false} res json 返回json ，例如[{_id:&quot;12345612&quot;,name:&quot;南六环&quot;,persons:[{_id:&quot;123456&quot;,name:&quot;张三&quot;},geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;]}}]case:true,加入{_id:&quot;案件ID&quot;,name:&quot;无照经营&quot;} &lt;inner&gt; getspotarea(req, res) 获取网格区域 Parameters: Name Type Description req 请求地址，无需传参 res json 返回json ，例如[{“_id”:&quot;网格区域ID&quot;,name:&quot;南六环&quot;,geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;}}] &lt;inner&gt; getworkmateinfo(req, res) 获取同部门人员的信息--未完成 Parameters: Name Type Description req json 客户端提交JSON 例如{_id:&quot;当前人员ID&quot;} res json 返回json ，例如[{_id:&quot;同事ID&quot;,name:&quot;张三&quot;,position:[&quot;116.446587&quot;,&quot;39.899989&quot;],status:1}] &lt;inner&gt; sendASpotarea(req, res) 上传制作网格区域 Parameters: Name Type Description req json 传入绘制网格json数据，例如{geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;},name:&quot;区域命名&quot;,type:&quot;市场&quot;} res json 返回成功后的json 例如：{_id: &quot;594f747ebdd246cc3b482c90&quot;,geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;},name:&quot;区域命名&quot;,type:&quot;市场&quot;,status:1,persons:[]} &lt;inner&gt; updatespotarea(req, res) 图层数据配置 修改图层信息，名称和范围 Parameters: Name Type Description req json 客户端提交JSON 例如{“_id”:&quot;图层ID&quot;,name:&quot;南六环&quot;,geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;}} res json 成功返回提示,失败返回空 × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E5%B7%A5%E4%BD%9C%E6%B6%88%E6%81%AF%E5%92%8C%E7%BE%A4%E4%BD%93%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%9D%97.html":{"id":"module-%E5%B7%A5%E4%BD%9C%E6%B6%88%E6%81%AF%E5%92%8C%E7%BE%A4%E4%BD%93%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%9D%97.html","title":"Module: 工作消息和群体通知模块","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 工作消息和群体通知模块 Methods &lt;inner&gt; afterSave(doc) 保存每条消息就自动的发送推送消息 Parameters: Name Type Description doc &lt;inner&gt; countByMessages(req, res) 对消息进行统计分析 Parameters: Name Type Description req json personId 人员id，sTime 统计时间段开始，eTime 统计时间段结束，countType 哪种统计方式 sendMessage|receiveMessage，timespan 时间采样类型 day|week|month res json 异常消息的数组 或者1个异常消息 或者 null 出错会返回{error:err} &lt;inner&gt; getAbnormaldMessageFeedback(req, res) 得到已回复的异常消息，用于异常消息的申请者查看自己的申请有没有批复 Parameters: Name Type Description req json senderId发送者id，这里一般是异常消息的申请者 abnormalID唯一的异常消息id（可以为null，这时就查出所有的已回复的异常消息） res json 异常消息的数组 或者1个异常消息 或者 null 出错会返回{error:err} &lt;inner&gt; getAllUnreadMessages(req, res) 根据用户id得到所有未读信息 Parameters: Name Type Description req json 传来的参数是接受者的id{receiverID:&quot;58dd96c9ac015a0809000070&quot;} res json 发回所有未读消息，如果没有就是null，如果有，类似{ create_date: 2017-04-02T11:04:34.638Z, images: {}, location: [ { positioningdate: 2017-04-02T11:04:34.639Z, SRS: '4326', _id: 58e0dac2e978587014e67f23, geolocation: [Object] } ], __v: 0, status: 0, receiver: 58dd96c9ac015a0809000070, sender: 58c043cc40cbb100091c640d, image: 'images/24368180-1794-11e7-a741-7d4b0ed433e3.jpg', text: '', _id: 58e0dac2e978587014e67f22 } &lt;inner&gt; getMessagesInATimeSpanFromWho(req, res) 得到一个时间段内某人发来的消息(type:“message“) 或者 群体消息(type:”broadcast“) Parameters: Name Type Description req Object 客户端提交的json{receiverID:&quot;sdfdsf&quot;,startTime:&quot;开始时间&quot;,lastTime:&quot;结束时间&quot;,&quot;senderID&quot;:&quot;发送者id&quot;，type：“broadcast|message”（跟发送者id不同时作用，可以只发送type为broadcast而不指定senderid，如果有明确的发送者id，且type未指定或者为‘message’时，就查询个人消息，否则就是群体消息）} Properties Name Type Description body.receiverID string 接受者id. body.senderID string 发送者id. body.type string 发送类型.broadcast或者message，当为broadcast时，senderID会忽略，否则会用上，&quot;takeoff放假|shift换班&quot; body.startTime datetime 开始时间. body.lastTime datetime 结束时间. res &lt;inner&gt; getMyNewestMessageFromWho(req, res) 得到一个人发送来的最新未读消息 Parameters: Name Type Description req json {receiverID:&quot;58c043cc40cbb100091c640d&quot;,senderID:&quot;58bff0836253fd4008b3d41b&quot;,isAbstract:false（是否需要摘要信息）// 如果是需要摘要信息，而且指定来源的消息数量》0// 如果不需要摘要信息，而且消息数量大于0} res json 如果是需要摘要的，就是这样{sender:senderID,count:消息数量,abstract:自动摘要, startTime:消息起始时间(&quot;yyyy-MM-dd hh:mm:ss&quot;), lastTime:消息结束时间(&quot;yyyy-MM-dd hh:mm:ss&quot;)}，如果不需要摘要就是消息的数组【{ create_date: 2017-04-02T11:04:34.638Z, images: {}, location: [ { positioningdate: 2017-04-02T11:04:34.639Z, SRS: '4326', _id: 58e0dac2e978587014e67f23, geolocation: [Object] } ], __v: 0, status: 0, receiver: 58dd96c9ac015a0809000070, sender: 58c043cc40cbb100091c640d, image: 'images/24368180-1794-11e7-a741-7d4b0ed433e3.jpg', text: '', _id: 58e0dac2e978587014e67f22 }，。。。】 &lt;inner&gt; readtAbnormalMessage(req, res) 读取了一个异常消息，将一个异常消息设置为已读，并且有同意和驳回两种选项 Parameters: Name Type Description req string req.body.messID消息的唯一id，req.body.decision ：approve；reject 同意，驳回,curUserID 当前用户id,abnormalID:一个异常可能给多人发，比如请假的申请，只要有一个人批准，就全部已读 res string 成功返回该消息id，失败返回null.对于请假消息，同意之后会在考勤状态表中生成一条请假状态，这样在计算考勤的时候，就不会被计入了 &lt;inner&gt; readtMessage(req, res) 读取了一个消息，将一个消息设置为已读，在查询未读消息的操作中就不会包括这个消息了 Parameters: Name Type Description req string req.body.messID消息的唯一id res string 成功返回该消息id，失败返回null &lt;inner&gt; sendAbnormalMessage(req, res) 发送异常性消息（主要是考勤中的请假和换班消息） Parameters: Name Type Description req json json形式：(senderID:“dfdf&quot;,type:&quot;takeoff|shift&quot;,senderTitle:&quot;123asd456&quot;,messageObj：{ text:&quot;文本内容&quot;,startTime:&quot;语音消息&quot;,video:&quot;视频消息&quot;,image:&quot;图片消息&quot;（四种消息必有一种） //异常状态也是一种消息//请假事由 由message.text兼任 abnormalStartTime:{ type: Date, default: Date.now}, abnormalEndTime:{ type: Date, default: Date.now}, abnormalShiftPersonId:String//换班人员id res json 发送失败 null，发送成功， 消息本身 &lt;inner&gt; sendAMessage(req, res) 发送个人消息 Parameters: Name Type Description req json json形式：(senderID:“发送者id&quot;,type:&quot;message&quot;(可以不写),receiverID:&quot;接受者id&quot;,messageObj：{ text:&quot;文本内容&quot;,voice:&quot;语音消息&quot;,video:&quot;视频消息&quot;,image:&quot;图片消息&quot;（四种消息必有一种）}&quot;) res json 发送成功返回 消息本身，发送失败发回 null &lt;inner&gt; sendBroadcast(req, res) 发送群体性消息 Parameters: Name Type Description req json json形式：(senderID:“dfdf&quot;,type:&quot;broadcast&quot;,receiverType:&quot;department(按部门发送)|title（按头衔发送）|persons（选择一些人发送）&quot;,messageObj：{ text:&quot;文本内容&quot;,voice:&quot;语音消息&quot;,video:&quot;视频消息&quot;,image:&quot;图片消息&quot;（四种消息必有一种）}，receiverInfo:&quot;(如果是部门，就是部门id数组，如果是title，就是title的id数组，如果是人员，就是人员的id数组)&quot;) res json 发送失败 null，发送成功， 消息本身 × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25A8%25A1%25E5%259D%2597.html":{"id":"module-%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25A8%25A1%25E5%259D%2597.html","title":"Module: 文件上传模块","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 文件上传模块 Methods &lt;inner&gt; uploadCommonFile(req, res) 将普通图片上传封装为一个函数，以供其他地方使用 url:/filedirectupload/photo Parameters: Name Type Description req file 普通图片文件 res json 成功后返回{ fileType:'commentImg', filename:'images/'+一个uuid的图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadCommonFile(req, res) 将普通图片上传封装为一个函数，以供其他地方使用 url:/filedirectupload/photo Parameters: Name Type Description req file 普通图片文件 res json 成功后返回{ fileType:'commentImg', filename:'images/'+一个uuid的图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadFile64(req, res) 自动根据类型识别存放文件夹 Parameters: Name Type Description req json 请求参数： file64：图片，语音，视频64位后的编码 type:上传文件类型（0:图片；1:语音；2:小视频）， url:/filedirectupload/uploadFile64 res json 正确返回 { fileType:'commentImg', filename:'images/'+imgfileName+&quot;.jpg&quot; }，{ fileType:'voice', filename:'voices/'+voicefileName+&quot;.m4a&quot; }，{ fileType:'video', filename:'videos/'+videofileName+&quot;.mp4&quot; }，错误返回{ err:'上传参数不对', filename:'null' } 或者文件保存错误会返回 错误详情 &lt;inner&gt; uploadFile64(req, res) 自动根据类型识别存放文件夹 Parameters: Name Type Description req json 请求参数： file64：图片，语音，视频64位后的编码 type:上传文件类型（0:图片；1:语音；2:小视频）， url:/filedirectupload/uploadFile64 res json 正确返回 { fileType:'commentImg', filename:'images/'+imgfileName+&quot;.jpg&quot; }，{ fileType:'voice', filename:'voices/'+voicefileName+&quot;.wav&quot; }，{ fileType:'video', filename:'videos/'+videofileName+&quot;.mp4&quot; }，错误返回{ err:'上传参数不对', filename:'null' } 或者文件保存错误会返回 错误详情 &lt;inner&gt; uploadIDcardsFile(req, res) 将身份证上传封装为一个函数，以供其他地方使用 url:/filedirectupload/IDCard Parameters: Name Type Description req file 身份证图像文件 res json 成功后返回{ fileType:'IDCard', filename:'IDCard/'+一个uuid的身份证图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadIDcardsFile(req, res) 将身份证上传封装为一个函数，以供其他地方使用 url:/filedirectupload/IDCard Parameters: Name Type Description req file 身份证图像文件 res json 成功后返回{ fileType:'IDCard', filename:'IDCard/'+一个uuid的身份证图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadImgs(ImgDir, imgfileName) 上传文件的基本函数 没有暴露出可访问url Parameters: Name Type Description ImgDir 文件路径 imgfileName 文件名 Returns: Type * &lt;inner&gt; uploadImgs(ImgDir, imgfileName) 上传文件的基本函数 没有暴露出可访问url Parameters: Name Type Description ImgDir 文件路径 imgfileName 文件名 Returns: Type * &lt;inner&gt; uploadVideoFile(req, res) // 将视频上传封装为一个函数，以供其他地方使用 url:/filedirectupload/video Parameters: Name Type Description req file 视频文件 res json 成功后返回{ fileType:'video', filename:'video/'+一个uuid的视频文件名+&quot;.mp4&quot; } 失败返回 null &lt;inner&gt; uploadVideoFile(req, res) // 将视频上传封装为一个函数，以供其他地方使用 url:/filedirectupload/video Parameters: Name Type Description req file 视频文件 res json 成功后返回{ fileType:'video', filename:'video/'+一个uuid的视频文件名+&quot;.mp4&quot; } 失败返回 null &lt;inner&gt; uploadVoicesFile(req, res) 将声音上传封装为一个函数，以供其他地方使用 url:/filedirectupload/voice Parameters: Name Type Description req file 声音文件 res json 成功后返回{ fileType:'voice', filename:'voice/'+一个uuid的声音文件名+&quot;.m4a&quot; } 失败返回 null &lt;inner&gt; uploadVoicesFile(req, res) 将声音上传封装为一个函数，以供其他地方使用 url:/filedirectupload/voice Parameters: Name Type Description req file 声音文件 res json 成功后返回{ fileType:'voice', filename:'voice/'+一个uuid的声音文件名+&quot;.m4a&quot; } 失败返回 null Module: 文件上传模块 Methods &lt;inner&gt; uploadCommonFile(req, res) 将普通图片上传封装为一个函数，以供其他地方使用 url:/filedirectupload/photo Parameters: Name Type Description req file 普通图片文件 res json 成功后返回{ fileType:'commentImg', filename:'images/'+一个uuid的图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadCommonFile(req, res) 将普通图片上传封装为一个函数，以供其他地方使用 url:/filedirectupload/photo Parameters: Name Type Description req file 普通图片文件 res json 成功后返回{ fileType:'commentImg', filename:'images/'+一个uuid的图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadFile64(req, res) 自动根据类型识别存放文件夹 Parameters: Name Type Description req json 请求参数： file64：图片，语音，视频64位后的编码 type:上传文件类型（0:图片；1:语音；2:小视频）， url:/filedirectupload/uploadFile64 res json 正确返回 { fileType:'commentImg', filename:'images/'+imgfileName+&quot;.jpg&quot; }，{ fileType:'voice', filename:'voices/'+voicefileName+&quot;.m4a&quot; }，{ fileType:'video', filename:'videos/'+videofileName+&quot;.mp4&quot; }，错误返回{ err:'上传参数不对', filename:'null' } 或者文件保存错误会返回 错误详情 &lt;inner&gt; uploadFile64(req, res) 自动根据类型识别存放文件夹 Parameters: Name Type Description req json 请求参数： file64：图片，语音，视频64位后的编码 type:上传文件类型（0:图片；1:语音；2:小视频）， url:/filedirectupload/uploadFile64 res json 正确返回 { fileType:'commentImg', filename:'images/'+imgfileName+&quot;.jpg&quot; }，{ fileType:'voice', filename:'voices/'+voicefileName+&quot;.wav&quot; }，{ fileType:'video', filename:'videos/'+videofileName+&quot;.mp4&quot; }，错误返回{ err:'上传参数不对', filename:'null' } 或者文件保存错误会返回 错误详情 &lt;inner&gt; uploadIDcardsFile(req, res) 将身份证上传封装为一个函数，以供其他地方使用 url:/filedirectupload/IDCard Parameters: Name Type Description req file 身份证图像文件 res json 成功后返回{ fileType:'IDCard', filename:'IDCard/'+一个uuid的身份证图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadIDcardsFile(req, res) 将身份证上传封装为一个函数，以供其他地方使用 url:/filedirectupload/IDCard Parameters: Name Type Description req file 身份证图像文件 res json 成功后返回{ fileType:'IDCard', filename:'IDCard/'+一个uuid的身份证图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadImgs(ImgDir, imgfileName) 上传文件的基本函数 没有暴露出可访问url Parameters: Name Type Description ImgDir 文件路径 imgfileName 文件名 Returns: Type * &lt;inner&gt; uploadImgs(ImgDir, imgfileName) 上传文件的基本函数 没有暴露出可访问url Parameters: Name Type Description ImgDir 文件路径 imgfileName 文件名 Returns: Type * &lt;inner&gt; uploadVideoFile(req, res) // 将视频上传封装为一个函数，以供其他地方使用 url:/filedirectupload/video Parameters: Name Type Description req file 视频文件 res json 成功后返回{ fileType:'video', filename:'video/'+一个uuid的视频文件名+&quot;.mp4&quot; } 失败返回 null &lt;inner&gt; uploadVideoFile(req, res) // 将视频上传封装为一个函数，以供其他地方使用 url:/filedirectupload/video Parameters: Name Type Description req file 视频文件 res json 成功后返回{ fileType:'video', filename:'video/'+一个uuid的视频文件名+&quot;.mp4&quot; } 失败返回 null &lt;inner&gt; uploadVoicesFile(req, res) 将声音上传封装为一个函数，以供其他地方使用 url:/filedirectupload/voice Parameters: Name Type Description req file 声音文件 res json 成功后返回{ fileType:'voice', filename:'voice/'+一个uuid的声音文件名+&quot;.m4a&quot; } 失败返回 null &lt;inner&gt; uploadVoicesFile(req, res) 将声音上传封装为一个函数，以供其他地方使用 url:/filedirectupload/voice Parameters: Name Type Description req file 声音文件 res json 成功后返回{ fileType:'voice', filename:'voice/'+一个uuid的声音文件名+&quot;.m4a&quot; } 失败返回 null × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E6%A8%A1%E5%9D%97.html":{"id":"module-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E6%A8%A1%E5%9D%97.html","title":"Module: 登录注册模块","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 登录注册模块 Methods &lt;inner&gt; getloginByUUId(req, res) 根据手机的uuid自动获取人员信息，也就是免登录 Parameters: Name Type Description req json {mobileUUid:&quot;手机的uuid&quot;} res json 成功就发回用户的json{ &quot;_id&quot; : ObjectId(&quot;58bff0836253fd4008b3d41b&quot;), &quot;name&quot; : &quot;谢进成&quot;, &quot;sex&quot; : &quot;男&quot;, &quot;nation&quot; : &quot;汉&quot;, &quot;birthday&quot; : &quot;1992-12-05&quot;, &quot;residence&quot; : &quot;云南省红河哈尼族彝族自治州泸西县年街铺镇阿茨龙村大路上45号&quot;, &quot;idNum&quot; : &quot;53252719921205171X&quot;, &quot;mobileUUid&quot; : &quot;123456789&quot;, &quot;create_date&quot; : ISODate(&quot;2017-03-08T11:52:35.361Z&quot;), &quot;__v&quot; : 26818, &quot;departments&quot; : [ { &quot;role&quot; : &quot;worker&quot;, &quot;department&quot; : ObjectId(&quot;58c3a5e9a63cf24c16a50b8c&quot;), &quot;_id&quot; : ObjectId(&quot;58c1d4f0f67649d0051efbd8&quot;) } ], &quot;role&quot; : &quot;worker&quot;, &quot;status&quot; : 9 }，失败发回null × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E7%BD%91%E6%A0%BC%E4%B8%9A%E5%8A%A1%E6%8E%A5%E5%8F%A3%20url_%20mobilegrid_mobilegridservice.html":{"id":"module-%E7%BD%91%E6%A0%BC%E4%B8%9A%E5%8A%A1%E6%8E%A5%E5%8F%A3%20url_%20mobilegrid_mobilegridservice.html","title":"Module: 网格业务接口 url: mobilegrid/mobilegridservice","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 网格业务接口 url: mobilegrid/mobilegridservice Methods &lt;inner&gt; getAllAbstracttype(req, res) 获取所有已定义的事件类型, 可用于新建事件选择事件类型 Parameters: Name Type Description req 发起请求 res json 返回数据[{typeName:'无照经营'，status:1,setDate:'2017-6-1',_id:'事件类型id'},.....] &lt;inner&gt; getAllConcreteevent(req, res) 获取部门事件 Parameters: Name Type Description req json 传所要查询的部门ID,例如：{departmentID:&quot;部门ID&quot;} res json 返回部门事件数组JSON,包含{type:类型, name:名称, _id:ID, newer:更新日期, step:步骤列表} &lt;inner&gt; getargutostep(req, res) 根据步骤获取所有步骤的参数 Parameters: Name Type Description req json 传入要事件的步骤ID,客户端提交json 例如{id:&quot;步骤ID&quot;} res json 返回此步骤的参数json数组[{identified:&quot;1&quot;,promptvalue:&quot;案发时间&quot;,setByWho:&quot;58c043cc40cbb100091c640d&quot;,setTime:&quot;2017-07-12T08:17:44.680Z&quot;,type:&quot;时间&quot;,value:Array(0),_id:&quot;5965db28eb1408f41ddfaa6e&quot;},.....] &lt;inner&gt; getcasestep(req, res) 获取当前案件的所有步骤 Parameters: Name Type Description req json 客户端发起请求 res json 服务器返回json，[{argu:[&quot;59648f04472f14b01de7a74f&quot;,&quot;59648f04472f14b01de7a750&quot;,&quot;59648f04472f14b01de7a751&quot;],currentPusher:&quot;null&quot;name:&quot;立案&quot;,no:1,status:&quot;2&quot;,type:&quot;无照经营&quot;wordTemplate:&quot;&lt;p style=&quot;text-a&quot;,_id:&quot;59648f04472f14b01de7a74e&quot;},....] &lt;inner&gt; getcompletestep(req, res) 获得所有已完成的步骤 Parameters: Name Type Description req json 客户端传入json，{id:'案件ID'} res json 服务器返回json，{argu:[&quot;59648f04472f14b01de7a74f&quot;,&quot;59648f04472f14b01de7a750&quot;,&quot;59648f04472f14b01de7a751&quot;],currentPusher:&quot;null&quot;name:&quot;立案&quot;,no:1,status:&quot;2&quot;,type:&quot;无照经营&quot;wordTemplate:&quot;&lt;p style=&quot;text-a&quot;,_id:&quot;59648f04472f14b01de7a74e&quot;} &lt;inner&gt; getcurrentstep(req, res) 获取当前需要进行的案件 Parameters: Name Type Description req json 客户端传入json，{id:'案件ID'} res json 服务器返回json，{argu:[&quot;59648f04472f14b01de7a74f&quot;,&quot;59648f04472f14b01de7a750&quot;,&quot;59648f04472f14b01de7a751&quot;],currentPusher:&quot;null&quot;name:&quot;立案&quot;,no:1,status:&quot;2&quot;,type:&quot;无照经营&quot;wordTemplate:&quot;&lt;p style=&quot;text-a&quot;,_id:&quot;59648f04472f14b01de7a74e&quot;} &lt;inner&gt; getDepartmentgird(req, res) 根据部门ID获得部门区域网格----待完善 Parameters: Name Type Description req json 传入要查询的部门ID,例如：{departmentID:&quot;部门ID&quot;} res json 返回部门网格区域的坐标数组，数组中包含每个坐标子数组,按每两个截取可拼成坐标[ [116.25612765372,40.1760414806014,116.273457389542,40.1458537654027,116.254320527215,40.1409379962385] ] &lt;inner&gt; getDepartmentparson(req, res) 获得部门人员 Parameters: Name Type Description req json 传入需要获取的部门ID,例如：{departmentID:&quot;部门ID&quot;} res json 返回部门内所有人员，及下级部门的人员数组JSON，包含姓名，ID{name:名称, _id:ID, images:头像, sex:性别, role:权限, mobileUUid:手机uuid} &lt;inner&gt; geteventSearch(req, res) 事件查询 根据类型，时间，区域，人员查询事件 Parameters: Name Type Description req json 传入类型,时间段,区域,参与人员。选择传入一个值{type:”事件类型“,time:{stertTime:&quot;起始日期&quot;,ediTime:&quot;结束日期&quot;},region:&quot;区域ID&quot;,person:['人员ID']} res json 返回{type:类型,name:名称,_id:ID,newer:更新日期,step:步骤列表} &lt;inner&gt; geteventStatus(req, res) 事件状态 Parameters: Name Type Description req json 传入参数（1,2,3）1是正在进行的,2是完结的,3是已删除的,客户端提交json 例如{status:1} res json 返回需要查询的状态json数组,数组中包含事件名称,ID,步骤{type:类型, name:名称, _id:ID, newer:更新日期, step:步骤列表} &lt;inner&gt; geteventstep(req, res) 获取事件所有步骤，传入事件的步骤ID Parameters: Name Type Description req json 客户端提交json，{id:'事件ID'} res json 返回所有事件步骤数组json，[{identified:&quot;1&quot;promptvalue:&quot;案发时间&quot;,setByWho:&quot;58c043cc40cbb100091c640d&quot;,setTime:&quot;2017-07-11T08:40:36.704Z&quot;,type:&quot;时间&quot;,value:Array(0),__v:0,_id:&quot;59648f04472f14b01de7a74f&quot;},.....] &lt;inner&gt; geteventTimestatistics(req, res) 事件处理时间段 事件统计 Parameters: Name Type Description req json 开始时间,结束时间,[建案日期,结案日期]按照建案日期,结案日期可以二选一，默认为结案日期,客户端提交json 例如{startTime:&quot;开始日期&quot;,ediTime:结束日期,start：,edi:} res json 返回需要查询的事件json数组,数组中包含事件名称,ID,步骤,按查询顺序返回{type:类型, name:名称, _id:ID, newer:更新日期, &lt;inner&gt; getEventtype(req, res) 获取待处理的事件列表--完善中根据部门查询所有待处理事件 Parameters: Name Type Description req json 传入要查询的待处理事件的部门ID,客户端提交json 例如{documentID:&quot;部门ID&quot;} res json 返回待处理事件的json数组[{type:类型,name:名称,_id:ID,no:步骤顺序,status:步骤状态}] &lt;inner&gt; getoneeventstep(req, res) 根据步骤ID获取步骤 Parameters: Name Type Description req json 传入要事件的步骤ID,客户端提交json 例如{id:&quot;步骤ID&quot;} res json 返回查询的步骤详细{type:类型,name:名称,_id:ID,no:步骤顺序,status:步骤状态,wordTemplate:'案件模板'，currentPusher:'这个步骤当前的责任人'} &lt;inner&gt; getpersonEvent(req, res) 人员处理的事件 ，（正在进行中的事件） Parameters: Name Type Description req json 传入要查询人员ID 客户端提交json 例如{personID:&quot;人员ID&quot;} res json 包含{type:类型, name:名称, _id:ID, newer:更新日期, step:步骤列表} &lt;inner&gt; getpersonRoute(req, res) 获取人员路线, 数据比较多，所以选的时间段范围尽量要小 * Parameters: Name Type Description req json 人员ID，起始时间，结束时间,{personID:&quot;人员ID&quot;,startTime:&quot;2017-05-16 07:45&quot;,endSTime:&quot;2017-05-16 10:45&quot;} res json 返回路线列表[{geolocation:[每个定位点],positioningdate:定位时间}] &lt;inner&gt; sendeeventDelete(req, res) 事件删除 Parameters: Name Type Description req json 客户端请求 json {id:'事件ID'} res json 返回成功或失败{error:null} &lt;inner&gt; sendeventargument(req, res) 填写参数完成，提交审核 Parameters: Name Type Description req json 传入步骤,参数,客户端提交json,argument的值是参数二维数组 例如{stepID:&quot;步骤ID&quot;,arguments:[[&quot;值1&quot;,&quot;值2&quot;],[&quot;设置人ID&quot;],[&quot;设置的密码&quot;]] res json 返回成功{success:'is OK!'}或失败响应{error: null}状态码 &lt;inner&gt; sendnewEvent(req, res) 新建一个事件,新建后可以调用/getcurrentstep获取第一步，进入立案 Parameters: Name Type Description req json 新建事件的名称、类型和所属部门（新建事件人员的部门）,案件位置, 客户端提交json 例如{name:'案件名称',type:&quot;案件类型,已定义好的类型ID&quot;,departmentID:'所属部门ID',position:[114.123456,40.123456]} res json 返回成功或失败{error: '参数提交错误'}响应状态码 × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E8%80%81%E7%9A%84%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url%EF%BC%9A_person.html":{"id":"module-%E8%80%81%E7%9A%84%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url%EF%BC%9A_person.html","title":"Module: 老的人员管理模块 url：/person","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 老的人员管理模块 url：/person Methods &lt;inner&gt; personAddByIDCard(req, res) 通过身份证解析后的json和手机uuid 和选定的部门id添加用户 Parameters: Name Type Description req json IDCard身份证识别方法返回的json 再添加 mobileUUid:&quot;手机的uuid&quot;，departments:[{department：“部门id”，role：“worker|admin|..”},..] res json 注册成功返回{'success':true,&quot;_id&quot;:“人员id”}注册失败返回{'success':false,'err':err} &lt;inner&gt; personPic(req, res) 通过url直接获取用户头像，get方法，./person/personPic?pid=111 Parameters: Name Type Description req String 人员id pid res binary/image jpeg图片 × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9D%97%20%20%20url%EF%BC%9A_processID.html":{"id":"module-%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9D%97%20%20%20url%EF%BC%9A_processID.html","title":"Module: 身份证识别模块   url：/processID","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 身份证识别模块 url：/processID Methods &lt;inner&gt; IDCard(req, res) 身份证图片识别方法，一般是紧跟着身份证图片上传方法的返回值进行调用 Parameters: Name Type Description req json {fileURL：“上传身份证照片后服务器返回的地址”} res json 如果识别正确返回{ name; sex; nation; birthday; residence; idNum; images={ coverSmall:'base64', coverBig:'',}}这些属性，如果失败，返回null × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "},"module-%E9%83%A8%E9%97%A8%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url_%20_personadminroute.html":{"id":"module-%E9%83%A8%E9%97%A8%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url_%20_personadminroute.html","title":"Module: 部门人员管理模块 url: /personadminroute","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /map工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: mobilegrid/mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute Global askforleavecountByDepartmentcountByMessagesexpressschedule Module: 部门人员管理模块 url: /personadminroute Methods &lt;inner&gt; getAllDepartment(req, res) 得到所有的部门包含人员ID Parameters: Name Type Description req 客户端发起请求，无需传参 res json 返回json：[{_id:&quot;123456&quot;,name:&quot;部门名称&quot;,status:1,info:'部门信息',persons:[[{_id:''}]] &lt;inner&gt; getAllDepartments(req, res) 获取得到所有有效的部门 Parameters: Name Type Description req 客户端发起请求，无需传参 res json 返回json：[{_id:&quot;123456&quot;,name:&quot;部门名称&quot;,status:1,info:'部门信息'}] &lt;inner&gt; getAllUserPic(req, res) 获取所有人员照片 Parameters: Name Type Description req 直接请求 res json 返回参数 [{_id:'1234',images:{}}] &lt;inner&gt; getdepartmentsstatus(req, res) 查看某一状态的部门， 只查看部门 Parameters: Name Type Description req json 客户端提交json 例如{status:1} res json 返回json：[{_id:&quot;123456&quot;,name:&quot;部门名称&quot;,status:1,info:'部门信息'}] &lt;inner&gt; getdepartmentTopeople(req, res) 获取部门的所有人员 Parameters: Name Type Description req json 客户端提交json 例如{department:&quot;部门ID&quot;} res json 返回json [{_id:'人员ID',&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',images:'',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;}}]; &lt;inner&gt; getIMid(req, res) 根据人员id 获取极光id Parameters: Name Type Description req 直接请求req.body.personID res json 返回参数 极光id 或者失败 {error: '获取失败'} &lt;inner&gt; getpersonstate(req, res) 根据人员状态，过滤人员,获取某一状态的人员 Parameters: Name Type Description req json 客户端提交json 例如{status:1} res json 返回json：[{_id:'人员ID',&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',images:'',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;}}]; &lt;inner&gt; getpersontitleTodepartment(req, res) 根据部门获取所有职务 Parameters: Name Type Description req json 客户端提交json 例如{departmentID:'123456'} res json 返回json：例如[ { name: '大队长', _id: 59520e5d7b6d7fa011adcc73 }] &lt;inner&gt; gettitleToperson(req, res) 根据职务筛选出人员 Parameters: Name Type Description req json 客户端提交json 例如{_id:'职务ID'} res json 返回json：例如[{ title: '5952112dea76066818fd6dd0', create_date: 2017-06-09T09:41:00.400Z, departments: [ [Object] ], status: 1, timeCard: [], __v: 0, birthday: '1983-02-28', age: 34, idNum: '460003198302283415', mobile: 13518037530, sex: '男', name: '吴兴学', _id: 593a6d2cf06286140edf82f1 }] &lt;inner&gt; getUserInfoById(req, res) 根据人员ID 获取人员头像 Parameters: Name Type Description req json 客户端传入参数 {personID:'12313'} res json 返回参数 [{_id:'1234',name:{}....}] &lt;inner&gt; getUserPicById(req, res) 根据人员ID 获取人员头像 Parameters: Name Type Description req json 客户端传入参数 {_id:'12313'} res json 返回参数 [{_id:'1234',images:{}}] &lt;inner&gt; sendispersonAdd(req, res) 用身份证信息验证一个人员是否已经导入,参数必须有身份证 Parameters: Name Type Description req json 客户端提交json 例如{&quot;name&quot;:&quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号'}; res json 返回bool值，true：激活用户，false：客户端提示是否需要管理员审核 &lt;inner&gt; sendnewdepartment(req, res) 新建一个部门 Parameters: Name Type Description req json 传入名称和上级部门id,客户端提交json 例如{name:'新建1',info:'新建描述',parentID:'上级部门id',info:'部门描述',infoLink:'www.baidu.com'} res json 返回json：例如{status:1} &lt;inner&gt; sendpersonimport(req, res) 人员录入，管理员录入人员 Parameters: Name Type Description req json 客户端提交json，例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回，录入成功返回提示成功，失败返回空字符串 &lt;inner&gt; sendpersonparent(req, res) 给职务添加一个上级 Parameters: Name Type Description req json 客户端提交json 例如{_id:'职务ID',parentTitle:'上级职务ID'} res json 返回成功{success:''} &lt;inner&gt; sendpersonreGister(req, res) 使用身份信息注册一个人员 Parameters: Name Type Description req json 传入人员json数据，例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;,IMid:'极光ID'}; res json 返回，注册成功返回提示成功，失败返回{error: '注册出错'} &lt;inner&gt; sendpersontitle(req, res) 修改或添加人员职务，职务是唯一的 Parameters: Name Type Description req json 客户端提交json 例如{_id:'人员ID',title:'职务ID'} res json 返回json：例如{success:'修改成功'} &lt;inner&gt; sendtitle(req, res) 在职务列表中添加一个职务,可以不传 parentTitle Parameters: Name Type Description req json 传入职务名称，部门名称和上级职务ID。客户端提交json 例如{name:'雇员',derpartmentID:'部门id',parentTitle:'上级职务ID'} res json 返回json：例如{_id:'123456',name:'雇员',derpartmentID:'部门id',parentTitle:'上级职务ID'} &lt;inner&gt; sendWaitExamineperson(req, res) 用身份证信息注册一个待审核人员 Parameters: Name Type Description req json 客户端提交json 例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回，注册成功返回提示成功{_id:'12345',&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;};失败返回{error:'添加失败'} &lt;inner&gt; setIMid(req, res) 根据人员id 设置极光id Parameters: Name Type Description req 直接请求 req.body.personID,req.body.IMid res json 返回参数 极光id 或者失败 {error: '获取失败'} &lt;inner&gt; updatedepartmentinfo(req, res) 编辑部门信息，修改名称，描述，官方网站，部门内部的头衔 Parameters: Name Type Description req json 客户端提交json 例如{_id:'123456',name:'修改1',info:'修改部门的信息',infoLink:'www.baidu.com',status:1} res json 返回json：例如{{success:'修改成功'}} &lt;inner&gt; updatedepartmentname(req, res) 部门改名 Parameters: Name Type Description req json 客户端提交部门ID和修改的名称 例如{_id:'12345',name:'mingceng'} res json 返回json：例如{success:'修改成功'} &lt;inner&gt; updatedepartmentstatus(req, res) 部门状态管理，修改部门状态 Parameters: Name Type Description req json 传入部门id，和要修改的状态，客户端提交json 例如{_id:'123456',status:1} res json 返回json：例如{success: '修改成功'} &lt;inner&gt; updatepersoninfo(req, res) 修改人员信息 ,传入修改的人员ID，和选择需要修改的内容 Parameters: Name Type Description req json 传入需要修改的人员ID ，客户端提交json 例如{_id:人员id,name: &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;} res json {success:'修改成功'} &lt;inner&gt; updatepersonstate(req, res) 修改人员状态 Parameters: Name Type Description req json 客户端提交json 例如{_id:人员id,status:1} res json 返回提示成功 × Search results Close Documentation generated by JSDoc 3.4.3 on July 13th 2017, 10:52:00 am using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
