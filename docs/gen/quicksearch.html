<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Global Members leave abnormal true,检查各个时间段，影响考勤规则，否则，直接读考勤状态 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Modules × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%9D%97%20url_%20%20_personalinfo.html":{"id":"module-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%9D%97%20url_%20%20_personalinfo.html","title":"Module: 个人信息配置模块 url:  /personalinfo","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 个人信息配置模块 url: /personalinfo Methods &lt;inner&gt; personjs(req, res) 离职 Parameters: Name Type Description req json res json &lt;inner&gt; personjs(req, res) 换班 Parameters: Name Type Description req json res json &lt;inner&gt; personjs(req, res) 请假 Parameters: Name Type Description req json 传入绘制网格json数据，例如{} res json 返回成功后的json 例如：{} &lt;inner&gt; personjs(req, res) 身份信息有误上报 Parameters: Name Type Description req json res json &lt;inner&gt; personjs(req, res) 脱岗 Parameters: Name Type Description req json res json &lt;inner&gt; personjs(req, res) 二维码扫描，登录桌面端 Parameters: Name Type Description req json res json &lt;inner&gt; updatepersonpassword(req, res) 修改自己的个人密码，必须输入原密码 Parameters: Name Type Description req json 客户端提交json，没有id可以提交身份证号， 例如{_id:'用户id',idNum:'用户身份证',opwd:'原密码',npwd:'新密码'} res json 返回提示修改成功，或者原密码错误 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E5%9C%B0%E5%9B%BE%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%20url_%20_maproute.html":{"id":"module-%E5%9C%B0%E5%9B%BE%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%20url_%20_maproute.html","title":"Module: 地图功能模块 url: /maproute","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 地图功能模块 url: /maproute Methods &lt;inner&gt; addperson(req, res) 进行网格和人员绑定 Parameters: Name Type Description req json 客户端提交json 例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:{job:'职务'},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回bool值，true：激活用户，false：客户端提示是否需要管理员审核 &lt;inner&gt; getcameraposition(req, res) 获取摄像头位置 Parameters: Name Type Description req 请求地址，无需传参 res json 返回json ，例如[{location：[109，38]，videoUrl：video.sohu.com，name：“保平村路口”，type：&quot;球形摄像头&quot;，protocol：“rstp”}] &lt;inner&gt; geteventposition(req, res) 待办事件坐标点 Parameters: Name Type Description req 请求地址，无需传参 res json 返回json ，例如[{_id:&quot;事件ID&quot;,name:&quot;无照经营&quot;,position:[&quot;116.446587&quot;,&quot;39.909989&quot;],newer:&quot;更新时间&quot;}] &lt;inner&gt; getmapdisplaysetting(req, res) 地图显示配置 选择显示同事，代办案件，网格区域，摄像头 Parameters: Name Type Description req json 客户端提交JSON 例如{“person“:true,&quot;case&quot;:false,&quot;area&quot;:true,&quot;camera&quot;:false} res json 返回json ，例如[{_id:&quot;12345612&quot;,name:&quot;南六环&quot;,persons:[{_id:&quot;123456&quot;,name:&quot;张三&quot;},geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;]}}]case:true,加入{_id:&quot;案件ID&quot;,name:&quot;无照经营&quot;} &lt;inner&gt; getspotarea(req, res) 获取网格区域 Parameters: Name Type Description req 请求地址，无需传参 res json 返回json ，例如[{“_id”:&quot;网格区域ID&quot;,name:&quot;南六环&quot;,geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;}}] &lt;inner&gt; getworkmateinfo(req, res) 获取同部门人员的信息 Parameters: Name Type Description req json 客户端提交JSON 例如{_id:&quot;当前人员ID&quot;} res json 返回json ，例如[{_id:&quot;同事ID&quot;,name:&quot;张三&quot;,position:[&quot;116.446587&quot;,&quot;39.899989&quot;],status:1}] &lt;inner&gt; sendASpotarea(req, res) 上传制作网格区域 Parameters: Name Type Description req json 传入绘制网格json数据，例如{geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;},name:&quot;区域命名&quot;,type:&quot;市场&quot;} res json 返回成功后的json 例如：{_id: &quot;594f747ebdd246cc3b482c90&quot;,geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;},name:&quot;区域命名&quot;,type:&quot;市场&quot;,status:1,persons:[]} &lt;inner&gt; updatespotarea(req, res) 图层数据配置 修改图层信息，名称和范围 Parameters: Name Type Description req json 客户端提交JSON 例如{“_id”:&quot;图层ID&quot;,name:&quot;南六环&quot;,geometry:{coordinates:[&quot;116.430587&quot;,&quot;39.909989”,&quot;116.430587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.899989&quot;,&quot;116.446587&quot;,&quot;39.909989&quot;],type:&quot;Polygon&quot;}} res json 成功返回提示,失败返回空 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E5%B7%A5%E4%BD%9C%E6%B6%88%E6%81%AF%E5%92%8C%E7%BE%A4%E4%BD%93%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%9D%97.html":{"id":"module-%E5%B7%A5%E4%BD%9C%E6%B6%88%E6%81%AF%E5%92%8C%E7%BE%A4%E4%BD%93%E9%80%9A%E7%9F%A5%E6%A8%A1%E5%9D%97.html","title":"Module: 工作消息和群体通知模块","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 工作消息和群体通知模块 Methods &lt;inner&gt; getAllUnreadMessages(req, res) 根据用户id得到所有未读信息 Parameters: Name Type Description req json 传来的参数是接受者的id{receiverID:&quot;58dd96c9ac015a0809000070&quot;} res json 发回所有未读消息，如果没有就是null，如果有，类似{ create_date: 2017-04-02T11:04:34.638Z, images: {}, location: [ { positioningdate: 2017-04-02T11:04:34.639Z, SRS: '4326', _id: 58e0dac2e978587014e67f23, geolocation: [Object] } ], __v: 0, status: 0, receiver: 58dd96c9ac015a0809000070, sender: 58c043cc40cbb100091c640d, image: 'images/24368180-1794-11e7-a741-7d4b0ed433e3.jpg', text: '', _id: 58e0dac2e978587014e67f22 } &lt;inner&gt; getMessagesInATimeSpanFromWho(req, res) 得到一个时间段内某人发来的消息 或者 群体消息（群体消息部分未实现） Parameters: Name Type Description req Object 客户端提交的json{receiverID:&quot;sdfdsf&quot;,startTime:&quot;开始时间&quot;,lastTime:&quot;结束时间&quot;,&quot;senderID&quot;:&quot;发送者id&quot;，type：“broadcast|message”（跟发送者id不同时作用，可以只发送type为broadcast而不指定senderid，如果有明确的发送者id，且type未指定或者为‘message’时，就查询个人消息，否则就是群体消息）} Properties Name Type Description body.receiverID string 接受者id. body.senderID string 发送者id. body.type string 发送类型.broadcast或者message，当为broadcast时，senderID会忽略，否则会用上 body.startTime datetime 开始时间. body.lastTime datetime 结束时间. res &lt;inner&gt; getMyNewestMessageFromWho(req, res) 得到一个人发送来的最新未读消息 Parameters: Name Type Description req json {receiverID:&quot;58c043cc40cbb100091c640d&quot;,senderID:&quot;58bff0836253fd4008b3d41b&quot;,isAbstract:false（是否需要摘要信息）// 如果是需要摘要信息，而且指定来源的消息数量》0// 如果不需要摘要信息，而且消息数量大于0} res json 如果是需要摘要的，就是这样{sender:senderID,count:消息数量,abstract:自动摘要, startTime:消息起始时间(&quot;yyyy-MM-dd hh:mm:ss&quot;), lastTime:消息结束时间(&quot;yyyy-MM-dd hh:mm:ss&quot;)}，如果不需要摘要就是消息的数组【{ create_date: 2017-04-02T11:04:34.638Z, images: {}, location: [ { positioningdate: 2017-04-02T11:04:34.639Z, SRS: '4326', _id: 58e0dac2e978587014e67f23, geolocation: [Object] } ], __v: 0, status: 0, receiver: 58dd96c9ac015a0809000070, sender: 58c043cc40cbb100091c640d, image: 'images/24368180-1794-11e7-a741-7d4b0ed433e3.jpg', text: '', _id: 58e0dac2e978587014e67f22 }，。。。】 &lt;inner&gt; readtMessage(req, res) 读取了一个消息，将一个消息设置为已读，在查询未读消息的操作中就不会包括这个消息了 Parameters: Name Type Description req string req.body.messID消息的唯一id res string 成功返回该消息id，失败返回null &lt;inner&gt; sendAMessage(req, res) 发送个人消息 Parameters: Name Type Description req json json形式：(senderID:“发送者id&quot;,type:&quot;message&quot;(可以不写),receiverID:&quot;接受者id&quot;,messageObj：{ text:&quot;文本内容&quot;,voice:&quot;语音消息&quot;,video:&quot;视频消息&quot;,image:&quot;图片消息&quot;（四种消息必有一种）}&quot;) res json 发送成功返回 消息本身，发送失败发回 null &lt;inner&gt; sendBroadcast(req, res) 发送群体性消息，未实现 Parameters: Name Type Description req json json形式：(senderID:“dfdf&quot;,type:&quot;broadcast&quot;,receiverType:&quot;department(按部门发送)|title（按头衔发送）|persons（选择一些人发送）&quot;,messageObj：{ text:&quot;文本内容&quot;,voice:&quot;语音消息&quot;,video:&quot;视频消息&quot;,image:&quot;图片消息&quot;（四种消息必有一种）}，receiverInfo:&quot;(如果是部门，就是部门id数组，如果是title，就是title的id数组，如果是人员，就是人员的id数组)&quot;) res json 发送失败 null，发送成功， 消息本身 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97.html":{"id":"module-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97.html","title":"Module: 文件上传模块","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 文件上传模块 Methods &lt;inner&gt; uploadCommonFile(req, res) 将普通图片上传封装为一个函数，以供其他地方使用 url:/filedirectupload/photo Parameters: Name Type Description req file 普通图片文件 res json 成功后返回{ fileType:'commentImg', filename:'images/'+一个uuid的图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadFile64(req, res) 自动根据类型识别存放文件夹 Parameters: Name Type Description req json 请求参数： file64：图片，语音，视频64位后的编码 type:上传文件类型（0:图片；1:语音；2:小视频）， url:/filedirectupload/uploadFile64 res json 正确返回 { fileType:'commentImg', filename:'images/'+imgfileName+&quot;.jpg&quot; }，{ fileType:'voice', filename:'voices/'+voicefileName+&quot;.m4a&quot; }，{ fileType:'video', filename:'videos/'+videofileName+&quot;.mp4&quot; }，错误返回{ err:'上传参数不对', filename:'null' } 或者文件保存错误会返回 错误详情 &lt;inner&gt; uploadIDcardsFile(req, res) 将身份证上传封装为一个函数，以供其他地方使用 url:/filedirectupload/IDCard Parameters: Name Type Description req file 身份证图像文件 res json 成功后返回{ fileType:'IDCard', filename:'IDCard/'+一个uuid的身份证图片文件名+&quot;.jpg&quot; } 失败返回 null &lt;inner&gt; uploadImgs(ImgDir, imgfileName) 上传文件的基本函数 没有暴露出可访问url Parameters: Name Type Description ImgDir 文件路径 imgfileName 文件名 Returns: Type * &lt;inner&gt; uploadVideoFile(req, res) // 将视频上传封装为一个函数，以供其他地方使用 url:/filedirectupload/video Parameters: Name Type Description req file 视频文件 res json 成功后返回{ fileType:'video', filename:'video/'+一个uuid的视频文件名+&quot;.mp4&quot; } 失败返回 null &lt;inner&gt; uploadVoicesFile(req, res) 将声音上传封装为一个函数，以供其他地方使用 url:/filedirectupload/voice Parameters: Name Type Description req file 声音文件 res json 成功后返回{ fileType:'voice', filename:'voice/'+一个uuid的声音文件名+&quot;.m4a&quot; } 失败返回 null × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E6%A8%A1%E5%9D%97.html":{"id":"module-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E6%A8%A1%E5%9D%97.html","title":"Module: 登录注册模块","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 登录注册模块 Methods &lt;inner&gt; getloginByUUId(req, res) 根据手机的uuid自动获取人员信息，也就是免登录 Parameters: Name Type Description req json {mobileUUid:&quot;手机的uuid&quot;} res json 成功就发回用户的json{ &quot;_id&quot; : ObjectId(&quot;58bff0836253fd4008b3d41b&quot;), &quot;name&quot; : &quot;谢进成&quot;, &quot;sex&quot; : &quot;男&quot;, &quot;nation&quot; : &quot;汉&quot;, &quot;birthday&quot; : &quot;1992-12-05&quot;, &quot;residence&quot; : &quot;云南省红河哈尼族彝族自治州泸西县年街铺镇阿茨龙村大路上45号&quot;, &quot;idNum&quot; : &quot;53252719921205171X&quot;, &quot;mobileUUid&quot; : &quot;123456789&quot;, &quot;create_date&quot; : ISODate(&quot;2017-03-08T11:52:35.361Z&quot;), &quot;__v&quot; : 26818, &quot;departments&quot; : [ { &quot;role&quot; : &quot;worker&quot;, &quot;department&quot; : ObjectId(&quot;58c3a5e9a63cf24c16a50b8c&quot;), &quot;_id&quot; : ObjectId(&quot;58c1d4f0f67649d0051efbd8&quot;) } ], &quot;role&quot; : &quot;worker&quot;, &quot;status&quot; : 9 }，失败发回null × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E7%BD%91%E6%A0%BC%E4%B8%9A%E5%8A%A1%E6%8E%A5%E5%8F%A3%20url_%20_mobilegridservice.html":{"id":"module-%E7%BD%91%E6%A0%BC%E4%B8%9A%E5%8A%A1%E6%8E%A5%E5%8F%A3%20url_%20_mobilegridservice.html","title":"Module: 网格业务接口 url: /mobilegridservice","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 网格业务接口 url: /mobilegridservice Methods &lt;inner&gt; addpersonCheckwork(req, res) 人员考勤- Parameters: Name Type Description req json 人员上班打卡，是查询,传入要考勤的人员ID,{personID:&quot;人员ID&quot;} res json 返回人员考勤成功或失败 &lt;inner&gt; getAllConcreteevent(req, res) 获取部门事件 Parameters: Name Type Description req json 传所要查询的部门ID,例如：{departmentID:&quot;部门ID&quot;} res json 返回部门事件数组JSON,包含{type:类型, name:名称, _id:ID, newer:更新日期, step:步骤列表} &lt;inner&gt; getDepartmentgird(req, res) 根据部门ID获得部门区域网格 Parameters: Name Type Description req json 传入要查询的部门ID,例如：{departmentID:&quot;部门ID&quot;} res json 返回部门网格区域的坐标数组，数组中包含每个坐标子数组,按每两个截取可拼成坐标[ [116.25612765372,40.1760414806014,116.273457389542,40.1458537654027,116.254320527215,40.1409379962385] ] &lt;inner&gt; getDepartmentparson(req, res) 获得部门人员 Parameters: Name Type Description req json 传入需要获取的部门ID,例如：{departmentID:&quot;部门ID&quot;} res json 返回部门内所有人员，及下级部门的人员数组JSON，包含姓名，ID{name:名称, _id:ID, images:头像, sex:性别, role:权限, mobileUUid:手机uuid} &lt;inner&gt; geteventSearch(req, res) 事件查询 根据类型，时间，区域，人员查询事件 Parameters: Name Type Description req json 传入类型,时间段,区域,参与人员。选择传入一个值{type:”事件类型“,time:{stertTime:&quot;起始日期&quot;,ediTime:&quot;结束日期&quot;},region:&quot;区域ID&quot;,person:['人员ID']} res json 返回{type:类型,name:名称,_id:ID,newer:更新日期,step:步骤列表} &lt;inner&gt; geteventStatus(req, res) 事件状态 Parameters: Name Type Description req json 传入参数（1,2,3）1是正在进行的,2是完结的,3是已删除的,客户端提交json 例如{status:1} res json 返回需要查询的状态json数组,数组中包含事件名称,ID,步骤{type:类型, name:名称, _id:ID, newer:更新日期, step:步骤列表} &lt;inner&gt; geteventTimestatistics(req, res) 事件处理时间段 事件统计 Parameters: Name Type Description req json 开始时间,结束时间,[建案日期,结案日期]按照建案日期,结案日期可以二选一，默认为结案日期,客户端提交json 例如{startTime:&quot;开始日期&quot;,ediTime:结束日期,start：,edi:} res json 返回需要查询的事件json数组,数组中包含事件名称,ID,步骤,按查询顺序返回{type:类型, name:名称, _id:ID, newer:更新日期, &lt;inner&gt; getEventtype(req, res) 获取待处理的事件列表根据部门查询所有待处理事件 Parameters: Name Type Description req json 传入要查询的待处理事件的部门ID,客户端提交json 例如{documentID:&quot;部门ID&quot;} res json 返回待处理事件的json数组{type:类型,name:名称,_id:ID,newer:更新日期,step:步骤列表} &lt;inner&gt; getpersonCheckwork(req, res) 获取人员考勤记录- Parameters: Name Type Description req json 传入要获取考勤的人员ID,{personID:&quot;人员ID&quot;,startTime:&quot;2017-05-16&quot;,endSTime:&quot;2017-06-16&quot;} res json 返回[{time:记录时间, record:考勤记录}] &lt;inner&gt; getpersonEvent(req, res) 人员处理的事件 ，（正在进行中的事件） Parameters: Name Type Description req json 传入要查询人员ID 客户端提交json 例如{personID:&quot;人员ID&quot;} res json 包含{type:类型, name:名称, _id:ID, newer:更新日期, step:步骤列表} &lt;inner&gt; getpersonRoute(req, res) 获取人员路线, 数据比较多，所以选的时间段范围尽量要小 * Parameters: Name Type Description req json 人员ID，起始时间，结束时间,{personID:&quot;人员ID&quot;,startTime:&quot;2017-05-16 07:45&quot;,endSTime:&quot;2017-05-16 10:45&quot;} res json 返回路线列表[{geolocation:[每个定位点],positioningdate:定位时间}] &lt;inner&gt; sendeventargument(req, res) 填写事件所需参数 Parameters: Name Type Description req json 传入步骤,参数,客户端提交json 例如{stepID:&quot;步骤ID&quot;,arguments:[{type:&quot;日期&quot;,value:[&quot;值1&quot;,&quot;值2&quot;]},setByWho:&quot;设置人ID&quot;,identified:&quot;设置的密码&quot;}] res json 返回成功或失败响应状态码 &lt;inner&gt; sendnewEvent(req, res) 新建一个事件 Parameters: Name Type Description req json 新建事件的名称和类型,类型是已定义好的类型模板客户端提交json 例如{name:'案件名称',type:&quot;案件类型,已定义好的类型ID&quot;} res json 返回成功或失败响应状态码 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E8%80%81%E7%9A%84%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url%EF%BC%9A_person.html":{"id":"module-%E8%80%81%E7%9A%84%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url%EF%BC%9A_person.html","title":"Module: 老的人员管理模块 url：/person","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 老的人员管理模块 url：/person Methods &lt;inner&gt; personAddByIDCard(req, res) 通过身份证解析后的json和手机uuid 和选定的部门id添加用户 Parameters: Name Type Description req json IDCard身份证识别方法返回的json 再添加 mobileUUid:&quot;手机的uuid&quot;，departments:[{department：“部门id”，role：“worker|admin|..”},..] res json 注册成功返回{'success':true,&quot;_id&quot;:“人员id”}注册失败返回{'success':false,'err':err} &lt;inner&gt; personPic(req, res) 通过url直接获取用户头像，get方法，./person/personPic?pid=111 Parameters: Name Type Description req String 人员id pid res binary/image jpeg图片 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9D%97%20%20%20url%EF%BC%9A_processID.html":{"id":"module-%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9D%97%20%20%20url%EF%BC%9A_processID.html","title":"Module: 身份证识别模块   url：/processID","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 身份证识别模块 url：/processID Methods &lt;inner&gt; IDCard(req, res) 身份证图片识别方法，一般是紧跟着身份证图片上传方法的返回值进行调用 Parameters: Name Type Description req json {fileURL：“上传身份证照片后服务器返回的地址”} res json 如果识别正确返回{ name; sex; nation; birthday; residence; idNum; images={ coverSmall:'base64', coverBig:'',}}这些属性，如果失败，返回null × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%E9%83%A8%E9%97%A8%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url_%20_personadminroute.html":{"id":"module-%E9%83%A8%E9%97%A8%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%20url_%20_personadminroute.html","title":"Module: 部门人员管理模块 url: /personadminroute","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: 部门人员管理模块 url: /personadminroute Methods &lt;inner&gt; getAllDepartment(req, res) 得到所有的部门包含人员ID Parameters: Name Type Description req 客户端发起请求，无需传参 res json 返回json：[{_id:&quot;123456&quot;,name:&quot;部门名称&quot;,status:1,info:'部门信息',persons:[[{_id:''}]] &lt;inner&gt; getAllDepartments(req, res) 获取得到所有有效的部门 Parameters: Name Type Description req 客户端发起请求，无需传参 res json 返回json：[{_id:&quot;123456&quot;,name:&quot;部门名称&quot;,status:1,info:'部门信息'}] &lt;inner&gt; getAllUserPic(req, res) 获取所有人员照片 Parameters: Name Type Description req 直接请求 res json 返回参数 [{_id:'1234',images:{}}] &lt;inner&gt; getdepartmentsstatus(req, res) 查看某一状态的部门， 只查看部门 Parameters: Name Type Description req json 客户端提交json 例如{status:1} res json 返回json：[{_id:&quot;123456&quot;,name:&quot;部门名称&quot;,status:1,info:'部门信息'}] &lt;inner&gt; getdepartmentTopeople(req, res) 根据部门查找人员 Parameters: Name Type Description req json 客户端提交json 例如{department:&quot;部门ID&quot;} res json 返回json [{_id:'人员ID',&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',images:'',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;}}]; &lt;inner&gt; getpersonstate(req, res) 根据人员状态，过滤人员,获取某一状态的人员 Parameters: Name Type Description req json 客户端提交json 例如{status:1} res json 返回json：[{_id:'人员ID',&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',images:'',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;}}]; &lt;inner&gt; getpersontitleTodepartment(req, res) 根据部门获取所有职务 Parameters: Name Type Description req json 客户端提交json 例如{departmentID:'123456'} res json 返回json：例如[ { name: '大队长', _id: 59520e5d7b6d7fa011adcc73 }] &lt;inner&gt; gettitleToperson(req, res) 根据职务筛选出人员 Parameters: Name Type Description req json 客户端提交json 例如{_id:'职务ID'} res json 返回json：例如[{ title: '5952112dea76066818fd6dd0', create_date: 2017-06-09T09:41:00.400Z, departments: [ [Object] ], status: 1, timeCard: [], __v: 0, birthday: '1983-02-28', age: 34, idNum: '460003198302283415', mobile: 13518037530, sex: '男', name: '吴兴学', _id: 593a6d2cf06286140edf82f1 }] &lt;inner&gt; getUserPicById(req, res) 根据人员ID 获取人员头像 Parameters: Name Type Description req json 客户端传入参数 {_id:'12313'} res json 返回参数 [{_id:'1234',images:{}}] &lt;inner&gt; sendispersonAdd(req, res) 用身份证信息验证一个人员是否已经导入,参数必须有身份证 Parameters: Name Type Description req json 客户端提交json 例如{&quot;name&quot;:&quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号'}; res json 返回bool值，true：激活用户，false：客户端提示是否需要管理员审核 &lt;inner&gt; sendnewdepartment(req, res) 新建一个部门 Parameters: Name Type Description req json 传入名称和上级部门id,客户端提交json 例如{name:'新建1',info:'新建描述',parentID:'上级部门id',info:'部门描述',infoLink:'www.baidu.com'} res json 返回json：例如{status:1} &lt;inner&gt; sendpersonimport(req, res) 人员录入，管理员录入人员 Parameters: Name Type Description req json 客户端提交json，例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回，录入成功返回提示成功，失败返回空字符串 &lt;inner&gt; sendpersonreGister(req, res) 使用身份信息注册一个人员 Parameters: Name Type Description req json 传入人员json数据，例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回，注册成功返回提示成功，失败返回{error: '注册出错'} &lt;inner&gt; sendpersontitle(req, res) 修改或添加人员职务，职务是唯一的 Parameters: Name Type Description req json 客户端提交json 例如{_id:'人员ID',title:'职务ID'} res json 返回json：例如{success:'修改成功'} &lt;inner&gt; sendtitle(req, res) 在职务列表中添加一个职务 Parameters: Name Type Description req json 传入职务名称，部门名称和上级职务ID。客户端提交json 例如{name:'雇员',derpartmentID:'部门id',parentTitle:'上级职务ID'} res json 返回json：例如{_id:'123456',name:'雇员',derpartmentID:'部门id',parentTitle:'上级职务ID'} &lt;inner&gt; sendWaitExamineperson(req, res) 用身份证信息注册一个待审核人员 Parameters: Name Type Description req json 客户端提交json 例如{&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;}; res json 返回，注册成功返回提示成功{_id:'12345',&quot;name&quot; : &quot;admin&quot;,&quot;sex&quot;:'男',&quot;nation&quot;:'汉',&quot;birthday&quot;:'1999-11-1',&quot;residence&quot;:'住址',&quot;idNum&quot;:'身份证号',&quot;departments&quot;:[{&quot;department&quot;:'部门id',role:&quot;权限&quot;}],&quot;title&quot;:&quot;职务ID&quot;},&quot;pwd&quot; : &quot;123456&quot;};失败返回{error:'添加失败'} &lt;inner&gt; updatedepartmentinfo(req, res) 编辑部门信息，修改名称，描述，官方网站，部门内部的头衔 Parameters: Name Type Description req json 客户端提交json 例如{_id:'123456',name:'修改1',info:'修改部门的信息',infoLink:'www.baidu.com',status:1} res json 返回json：例如{{success:'修改成功'}} &lt;inner&gt; updatedepartmentname(req, res) 部门改名 Parameters: Name Type Description req json 客户端提交部门ID和修改的名称 例如{_id:'12345',name:'mingceng'} res json 返回json：例如{success:'修改成功'} &lt;inner&gt; updatedepartmentstatus(req, res) 部门状态管理，修改部门状态 Parameters: Name Type Description req json 传入部门id，和要修改的状态，客户端提交json 例如{_id:'123456',status:1} res json 返回json：例如{success: '修改成功'} &lt;inner&gt; updatepersonstate(req, res) 修改人员状态 Parameters: Name Type Description req json 客户端提交json 例如{_id:人员id,status:1} res json 返回提示成功 × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "},"module-%EF%BF%BD%C4%BC%EF%BF%BD%EF%BF%BD%CF%B4%EF%BF%BD%C4%A3%EF%BF%BD%EF%BF%BD.html":{"id":"module-%EF%BF%BD%C4%BC%EF%BF%BD%EF%BF%BD%CF%B4%EF%BF%BD%C4%A3%EF%BF%BD%EF%BF%BD.html","title":"Module: �ļ��ϴ�ģ��","body":" Documentation Modules 个人信息配置模块 url: /personalinfo地图功能模块 url: /maproute工作消息和群体通知模块文件上传模块登录注册模块网格业务接口 url: /mobilegridservice老的人员管理模块 url：/person身份证识别模块 url：/processID部门人员管理模块 url: /personadminroute�ļ��ϴ�ģ�� Global leave Module: �ļ��ϴ�ģ�� Methods &lt;inner&gt; uploadCommonFile(req, res) ����ͨͼƬ�ϴ���װΪһ���������Թ������ط�ʹ�� url:/filedirectupload/photo Parameters: Name Type Description req file ��ͨͼƬ�ļ� res json �ɹ��󷵻�{ fileType:'commentImg', filename:'images/'+һ��uuid��ͼƬ�ļ���+&quot;.jpg&quot; } ʧ�ܷ��� null &lt;inner&gt; uploadFile64(req, res) �Զ���������ʶ�������ļ��� Parameters: Name Type Description req json ���������� file64��ͼƬ����������Ƶ64λ���ı��� type:�ϴ��ļ����ͣ�0:ͼƬ��1:������2:С��Ƶ���� url:/filedirectupload/uploadFile64 res json ��ȷ���� { fileType:'commentImg', filename:'images/'+imgfileName+&quot;.jpg&quot; }��{ fileType:'voice', filename:'voices/'+voicefileName+&quot;.m4a&quot; }��{ fileType:'video', filename:'videos/'+videofileName+&quot;.mp4&quot; }�����󷵻�{ err:'�ϴ���������', filename:'null' } �����ļ����������᷵�� �������� &lt;inner&gt; uploadIDcardsFile(req, res) ������֤�ϴ���װΪһ���������Թ������ط�ʹ�� url:/filedirectupload/IDCard Parameters: Name Type Description req file ����֤ͼ���ļ� res json �ɹ��󷵻�{ fileType:'IDCard', filename:'IDCard/'+һ��uuid������֤ͼƬ�ļ���+&quot;.jpg&quot; } ʧ�ܷ��� null &lt;inner&gt; uploadImgs(ImgDir, imgfileName) �ϴ��ļ��Ļ������� û�б�¶���ɷ���url Parameters: Name Type Description ImgDir �ļ�·�� imgfileName �ļ��� Returns: Type * &lt;inner&gt; uploadVideoFile(req, res) // ����Ƶ�ϴ���װΪһ���������Թ������ط�ʹ�� url:/filedirectupload/video Parameters: Name Type Description req file ��Ƶ�ļ� res json �ɹ��󷵻�{ fileType:'video', filename:'video/'+һ��uuid����Ƶ�ļ���+&quot;.mp4&quot; } ʧ�ܷ��� null &lt;inner&gt; uploadVoicesFile(req, res) �������ϴ���װΪһ���������Թ������ط�ʹ�� url:/filedirectupload/voice Parameters: Name Type Description req file �����ļ� res json �ɹ��󷵻�{ fileType:'voice', filename:'voice/'+һ��uuid�������ļ���+&quot;.m4a&quot; } ʧ�ܷ��� null × Search results Close Documentation generated by JSDoc 3.4.3 on June 29th 2017, 5:19:10 pm using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
